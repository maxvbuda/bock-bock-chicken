<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Cluckington Family</title>
  <link rel="icon" type="image/x-icon" href="images/favicon.ico">
  
  <!-- PostHog Analytics -->
  <script>
    !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.async=!0,p.src=s.api_host+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys onSessionId".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
    posthog.init('phc_sloVEwzIB8ds3BbJpYmgxRj36tofr4gVi4YcMnqikco',{api_host:'https://us.i.posthog.com'})
  </script>
  
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  
  <style>
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes float {
      0%, 100% {
        transform: translateY(0px);
      }
      50% {
        transform: translateY(-10px);
      }
    }
    
    @keyframes shimmer {
      0% {
        background-position: -1000px 0;
      }
      100% {
        background-position: 1000px 0;
      }
    }
    
    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.05);
      }
    }
    
    body {
      margin: 0;
      font-family: 'Poppins', 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      color: #333;
      overflow-x: hidden;
    }
    
    .top-menu {
      width: 100%;
      background: linear-gradient(to right, #fffdf7, #fff5e1);
      border-bottom: 3px solid #e6d1a3;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 0;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      backdrop-filter: blur(10px);
    }
    
    .top-menu ul {
      list-style: none;
      margin: 0;
      padding: 8px 0;
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .top-menu li {
      display: inline;
    }
    
    .top-menu a {
      display: inline-block;
      padding: 12px 24px;
      font-size: 1em;
      color: #fff;
      background: linear-gradient(135deg, #d97428 0%, #c96620 100%);
      border: none;
      border-radius: 12px;
      font-family: 'Quicksand', 'Georgia', serif;
      font-weight: 600;
      text-decoration: none;
      box-shadow: 0 4px 15px rgba(217, 116, 40, 0.3);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    
    .top-menu a::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.5s;
    }
    
    .top-menu a:hover::before {
      left: 100%;
    }
    
    .top-menu a:hover {
      background: linear-gradient(135deg, #a85c1a 0%, #8a4a15 100%);
      color: #ffe4b3;
      text-decoration: none;
      box-shadow: 0 6px 25px rgba(217, 116, 40, 0.4);
      transform: translateY(-2px);
    }
    
    .top-menu a.active {
      background: linear-gradient(135deg, #fffbe7 0%, #fff5d6 100%);
      color: #d97428;
      border: 2px solid #d97428;
      cursor: default;
      box-shadow: 0 4px 15px rgba(217, 116, 40, 0.2);
      pointer-events: none;
    }
    
    .section {
      width: 100%;
      background: linear-gradient(to bottom, #fffdf7, #fff5e1);
      padding: 80px 20px 60px 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      border-bottom: 3px solid #e6d1a3;
      animation: fadeInUp 0.8s ease-out;
    }
    
    .section img {
      max-width: 85%;
      max-height: 75vh;
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
      margin-bottom: 40px;
      transition: transform 0.4s ease, box-shadow 0.4s ease;
      animation: float 6s ease-in-out infinite;
    }
    
    .section img:hover {
      transform: scale(1.02) translateY(-5px);
      box-shadow: 0 30px 80px rgba(0, 0, 0, 0.25);
    }
    
    .family-title {
      font-size: 3em;
      background: linear-gradient(135deg, #d97428 0%, #e88e3f 50%, #d97428 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 32px;
      font-family: 'Quicksand', 'Georgia', serif;
      font-weight: 700;
      margin-top: 40px;
      text-align: center;
      animation: fadeInUp 1s ease-out 0.2s both;
      text-shadow: 2px 2px 4px rgba(217, 116, 40, 0.1);
      letter-spacing: 1px;
    }
    
    .story {
      font-size: 1.15em;
      line-height: 1.8;
      background: linear-gradient(135deg, #ffffff 0%, #fffef9 100%);
      padding: 32px;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
      max-width: 750px;
      border: 2px solid #f5ead0;
      animation: fadeInUp 1s ease-out 0.4s both;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .story:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 50px rgba(0, 0, 0, 0.15);
    }
  </style>
</head>
<body>
  <nav class="top-menu">
    <ul>
      <li><a href="index.html" class="active">The Cluckington Family</a></li>
      <li><a href="family-members.html">Family Members</a></li>
      <li><a href="golden-knight.html">The Golden Knight of Chickenopolis</a></li>
      <li><a href="homework.html">Homework Kanban</a></li>
      <li><a href="games.html">Games</a></li>
      <li><a href="sailing-data-tool.html">Wind Forecaster</a></li>
      <li><a href="teach-me-anything.html">Teach Me Anything</a></li>
      <li><a href="chat-with-peep.html">Chat with Sir Peepius</a></li>
      <li><a href="bedtime-stories.html">Bedtime Stories</a></li>
    </ul>
  </nav>
  <section class="section" id="cluckington-family">
    <img src="images/medieval_chicken_village.png" alt="Chicken Family Village">
    <div class="family-title">The Cluckington Family</div>
    <div class="story">
      Once upon a time in the bustling streets of Chickenopolis, lived the Cluckington family‚Äîa heroic bunch of
      chickens with a knack for adventure. <br><br>
      <div id="family-members">
        Mother Henrietta Cluckington was famous for her delicious and long lasting corn muffins, while Father Roostwell
        Cluckington always woke up the city with his proud crowing at dawn and was known for stopping all of those pesky
        animals that try to eat them. Their three chicks‚ÄîPeep, Cheepers, and Nugget‚Äîwanted to be as heroic as their
        father.
      </div>
      <br><br>
      One spring morning, the Cluckingtons decided to host the annual "Egg-stravaganza," a festival where chickens
      from all corners of Chickenopolis gathered to race, dance, and hunt for the legendary golden egg. Peep, the
      youngest, dreamed of finding the egg and becoming the hero of the day.<br><br>
      With teamwork, laughter, and a sprinkle of luck, the Cluckington family faced muddy puddles, tricky mazes, and
      even a surprise visit from the wise old Professor Featherbeak. In the end, Peep discovered the golden egg hidden
      beneath the oldest oak tree, bringing joy and pride to the family.<br><br>
      From that day on, the Cluckingtons became legends in Chickenopolis, proving that with family, friendship, and a
      little bit of cluck, anything is possible!
    </div>
    <div style="text-align:center; margin: 24px 0;">
      <button id="autoread-toggle-btn" style="font-size:1.15em; padding: 14px 32px; background: linear-gradient(135deg, #ffe4b3 0%, #ffd99e 100%); color: #7a4a13; border: 2px solid #e6d1a3; border-radius: 12px; box-shadow: 0 6px 20px rgba(217, 116, 40, 0.25); cursor: pointer; font-family: 'Quicksand', 'Georgia', serif; font-weight: 600; transition: all 0.3s ease; animation: pulse 2s ease-in-out infinite;">üîä Read Story</button>
    </div>
  </section>

  <!-- Audio Play Button -->
  <div id="audio-fallback-btn-container" style="text-align:center; margin: 40px 0;">
    <button id="audio-fallback-btn" style="font-size:1.2em; padding: 16px 36px; background: linear-gradient(135deg, #ffe4b3 0%, #ffd99e 100%); color: #7a4a13; border: 2px solid #e6d1a3; border-radius: 14px; box-shadow: 0 8px 25px rgba(217, 116, 40, 0.3); cursor: pointer; font-family: 'Quicksand', 'Georgia', serif; font-weight: 600; transition: all 0.3s ease;">üéµ Play Theme Audio</button>
    <div style="color:#c74444; font-size:0.95em; margin-top:12px; font-family: 'Poppins', sans-serif;">If you don't hear music, click the button above.</div>
  </div>
  <!-- Hidden YouTube iframe for audio -->
  <div style="position: absolute; left: -9999px; width: 1px; height: 1px; overflow: hidden;">
    <div id="yt-audio"></div>
  </div>
  <script>
    // --- Autoread Story with Start/Stop Button ---
    (function() {
      let utter = null;
      let isReading = false;
      function speakStory() {
        if (!('speechSynthesis' in window)) return;
        if (isReading) return;
        const storyEl = document.querySelector('.story');
        if (!storyEl) return;
        const text = storyEl.innerText || storyEl.textContent;
        if (!text) return;
        utter = new window.SpeechSynthesisUtterance(text);
        utter.rate = 1.08;
        utter.pitch = 1.1;
        utter.volume = 1;
        isReading = true;
        updateBtn();
        window.speechSynthesis.speak(utter);
        utter.onend = function() { isReading = false; updateBtn(); };
        utter.onerror = function() { isReading = false; updateBtn(); };
      }
      function stopStory() {
        if (!('speechSynthesis' in window)) return;
        window.speechSynthesis.cancel();
        isReading = false;
        updateBtn();
      }
      function updateBtn() {
        const btn = document.getElementById('autoread-toggle-btn');
        if (!btn) return;
        btn.textContent = isReading ? '‚èπÔ∏è Stop Reading' : 'üîä Read Story';
      }
      window.addEventListener('DOMContentLoaded', function() {
        const btn = document.getElementById('autoread-toggle-btn');
        if (btn) {
          btn.onclick = function() {
            if (isReading) {
              stopStory();
            } else {
              speakStory();
            }
          };
        }
      });
    })();
    let ytPlayer;
    let ytApiReady = false;
    let audioPlayed = false;
    let fallbackShown = false;
    // Load YouTube IFrame API
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    // Save playback time before navigating away
    function saveAudioTime() {
      if (ytPlayer && ytPlayer.getCurrentTime) {
        try {
          localStorage.setItem('bockbock_audio_time', ytPlayer.getCurrentTime());
        } catch (e) {}
      }
    }
    // Attach to all menu links
    document.addEventListener('DOMContentLoaded', function() {
      document.querySelectorAll('.top-menu a').forEach(function(link) {
        if (!link.classList.contains('active')) {
          link.addEventListener('click', saveAudioTime);
        }
      });
    });

    function hideFallbackButton() {
      if (!fallbackShown) {
        document.getElementById('audio-fallback-btn-container').style.display = 'none';
        fallbackShown = true;
      }
    }

    function tryPlayAudio(player) {
      // Always hide the button immediately on any play attempt
      hideFallbackButton();
      try {
        player.unMute();
        player.playVideo();
      } catch (e) {
        // Do nothing, button stays visible
      }
    }

    function createAndPlayYTPlayer() {
      if (audioPlayed || !ytApiReady) return;
      audioPlayed = true;
      hideFallbackButton(); // Hide button immediately
      ytPlayer = new YT.Player('yt-audio', {
        height: '1',
        width: '1',
        videoId: '5j1y_aZORZs',
        events: {
          'onReady': function(event) {
            event.target.mute();
            // Always seek to saved time or 0 if at end
            let t = 0;
            let duration = 0;
            try {
              t = parseFloat(localStorage.getItem('bockbock_audio_time'));
              duration = event.target.getDuration ? event.target.getDuration() : 0;
            } catch (e) {}
            if (!isNaN(t) && t > 0 && (!duration || t < duration - 2)) {
              event.target.seekTo(t, true);
            } else {
              event.target.seekTo(0, true);
            }
            // Always try to play and unmute after seeking
            setTimeout(function() {
              event.target.unMute();
              event.target.playVideo();
              // If not playing, force play again
              setTimeout(function() {
                if (event.target.getPlayerState && event.target.getPlayerState() !== 1) {
                  event.target.playVideo();
                }
              }, 600);
            }, 800);
            hideFallbackButton();
          },
          'onStateChange': function(event) {
            // Loop the video when it ends
            if (event.data === YT.PlayerState.ENDED) {
              event.target.seekTo(0, true);
              event.target.playVideo();
            }
          },
          'onError': function() {
            // Do nothing, button stays visible
          }
        }
      });
      window.removeEventListener('click', createAndPlayYTPlayer);
      window.removeEventListener('keydown', createAndPlayYTPlayer);
      window.removeEventListener('scroll', createAndPlayYTPlayer);
      // Fallback: if player not created after 3 seconds, show button
      setTimeout(function() {
        if (!ytPlayer) showFallbackButton();
      }, 3000);
    }

    window.onYouTubeIframeAPIReady = function() {
      ytApiReady = true;
      // Listen for first user interaction
      window.addEventListener('click', createAndPlayYTPlayer);
      window.addEventListener('keydown', createAndPlayYTPlayer);
      window.addEventListener('scroll', createAndPlayYTPlayer);
    };

    // Fallback button handler
    document.addEventListener('DOMContentLoaded', function() {
      var btn = document.getElementById('audio-fallback-btn');
      if (btn) {
        btn.addEventListener('click', function() {
          hideFallbackButton();
          if (ytPlayer && ytPlayer.playVideo) {
            ytPlayer.unMute();
            ytPlayer.playVideo();
            // If not playing, force play again
            setTimeout(function() {
              if (ytPlayer.getPlayerState && ytPlayer.getPlayerState() !== 1) {
                ytPlayer.playVideo();
              }
            }, 600);
          } else {
            // If player not created, create and play
            createAndPlayYTPlayer();
          }
        });
      }
      // Button is visible by default, nothing to do
    });
    // --- Chicken Chatbot UI and Logic ---
    (function() {
      const style = document.createElement('style');
      style.textContent = `
        .chicken-chatbot {
          position: fixed;
          bottom: 32px;
          right: 32px;
          width: 360px;
          max-width: 92vw;
          background: linear-gradient(135deg, #fffef9 0%, #fff5e1 100%);
          border: 3px solid #e6d1a3;
          border-radius: 24px;
          box-shadow: 0 15px 50px rgba(0,0,0,0.25);
          z-index: 2147483647;
          display: flex;
          flex-direction: column;
          font-family: 'Poppins', 'Segoe UI', Arial, sans-serif;
          transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .chicken-chatbot:hover {
          box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .chicken-chatbot.minimized {
          width: 80px !important;
          height: 80px !important;
          min-width: 0 !important;
          min-height: 0 !important;
          overflow: visible !important;
          background: linear-gradient(135deg, #fffbe7 0%, #ffe4b3 100%) !important;
          border: 4px solid #d97428 !important;
          box-shadow: 0 10px 30px rgba(217, 116, 40, 0.4) !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          padding: 0 !important;
          border-radius: 50% !important;
          cursor: pointer !important;
          z-index: 99999 !important;
          animation: pulse 2s ease-in-out infinite;
        }
        .chicken-chatbot.minimized:hover {
          transform: scale(1.1);
          box-shadow: 0 15px 40px rgba(217, 116, 40, 0.5) !important;
        }
        .chicken-chatbot-header {
          display: flex;
          align-items: center;
          background: linear-gradient(135deg, #ffe4b3 0%, #ffd99e 100%);
          border-bottom: 2px solid #e6d1a3;
          border-radius: 20px 20px 0 0;
          padding: 12px 14px 12px 12px;
          gap: 12px;
        }
        .chicken-face {
          width: 42px;
          height: 42px;
          border-radius: 50%;
          background: linear-gradient(135deg, #fffbe7 0%, #fff5d6 100%);
          border: 3px solid #d97428;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 1.9em;
          margin-right: 4px;
          transition: transform 0.3s ease;
          cursor: pointer;
        }
        .chicken-face:hover {
          transform: rotate(10deg) scale(1.1);
        }
        .chicken-chatbot-title {
          font-weight: 700;
          color: #d97428;
          font-size: 1.15em;
          flex: 1;
          font-family: 'Quicksand', sans-serif;
        }
        .chicken-chatbot-btn {
          background: none;
          border: none;
          color: #d97428;
          font-size: 1.4em;
          cursor: pointer;
          margin-left: 4px;
          transition: all 0.3s ease;
          padding: 4px;
          border-radius: 8px;
        }
        .chicken-chatbot-btn:hover {
          color: #a85c1a;
          background: rgba(217, 116, 40, 0.1);
          transform: scale(1.15);
        }
        .chicken-chatbot-body {
          padding: 18px 16px 14px 16px;
          flex: 1;
          overflow-y: auto;
          background: linear-gradient(to bottom, #fffef9, #fff5e1);
          min-height: 140px;
          max-height: 300px;
        }
        .chicken-chatbot-messages {
          display: flex;
          flex-direction: column;
          gap: 12px;
        }
        .chicken-chatbot-message {
          border-radius: 16px;
          padding: 10px 14px;
          max-width: 82%;
          font-size: 0.95em;
          word-break: break-word;
          animation: fadeInUp 0.3s ease-out;
          box-shadow: 0 2px 8px rgba(0,0,0,0.08);
          transition: transform 0.2s ease;
        }
        .chicken-chatbot-message:hover {
          transform: translateX(3px);
        }
        .chicken-chatbot-message.user {
          align-self: flex-end;
          background: linear-gradient(135deg, #d97428 0%, #c96620 100%);
          color: #fffbe7;
        }
        .chicken-chatbot-message.bot {
          align-self: flex-start;
          background: linear-gradient(135deg, #ffffff 0%, #fffef9 100%);
          color: #a85c1a;
          border: 2px solid #e6d1a3;
        }
        .chicken-chatbot-footer {
          display: flex;
          align-items: center;
          padding: 12px 14px 14px 14px;
          border-radius: 0 0 20px 20px;
          background: linear-gradient(to bottom, #fff5e1, #fffbe7);
          border-top: 2px solid #e6d1a3;
        }
        .chicken-chatbot-input {
          flex: 1;
          padding: 10px 14px;
          border-radius: 12px;
          border: 2px solid #e6d1a3;
          font-size: 1em;
          outline: none;
          font-family: 'Poppins', sans-serif;
          transition: all 0.3s ease;
        }
        .chicken-chatbot-input:focus {
          border-color: #d97428;
          box-shadow: 0 0 0 3px rgba(217, 116, 40, 0.1);
        }
        .chicken-chatbot-send-btn {
          background: linear-gradient(135deg, #d97428 0%, #c96620 100%);
          color: #fffbe7;
          border: none;
          border-radius: 12px;
          font-size: 1.1em;
          padding: 10px 18px;
          margin-left: 10px;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: 0 4px 12px rgba(217, 116, 40, 0.3);
          font-weight: 600;
        }
        .chicken-chatbot-send-btn:hover {
          background: linear-gradient(135deg, #a85c1a 0%, #8a4a15 100%);
          transform: translateY(-2px);
          box-shadow: 0 6px 16px rgba(217, 116, 40, 0.4);
        }
        .chicken-chatbot.minimized .chicken-chatbot-header {
          border-radius: 50%;
          background: transparent;
          border: none;
          padding: 0;
          justify-content: center;
          width: 80px;
          height: 80px;
          align-items: center;
          display: flex;
          visibility: visible !important;
          pointer-events: auto !important;
        }
        .chicken-chatbot.minimized .chicken-face {
          margin: 0;
          width: 60px;
          height: 60px;
          font-size: 3em;
          border: none;
          background: transparent;
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: none;
        }
        .chicken-chatbot.minimized .chicken-chatbot-title,
        .chicken-chatbot.minimized .chicken-chatbot-btn:not(#chicken-chatbot-min),
        .chicken-chatbot.minimized .chicken-chatbot-body,
        .chicken-chatbot.minimized .chicken-chatbot-footer {
          visibility: hidden !important;
          pointer-events: none !important;
          height: 0 !important;
          width: 0 !important;
          min-width: 0 !important;
          min-height: 0 !important;
          max-width: 0 !important;
          max-height: 0 !important;
          overflow: hidden !important;
          display: block !important;
          position: absolute !important;
          left: -9999px !important;
          top: -9999px !important;
        }
        .chicken-chatbot.minimized .chicken-chatbot-btn#chicken-chatbot-min {
          display: none !important;
        }
      `;
      document.head.appendChild(style);

      // Create chatbot container
  const chatbot = document.createElement('div');
  chatbot.className = 'chicken-chatbot minimized';
  chatbot.innerHTML = `
        <div class="chicken-chatbot-header">
          <div class="chicken-face" title="Chicken Chatbot">üêî</div>
          <div class="chicken-chatbot-title">Chicken Chatbot</div>
          <button class="chicken-chatbot-btn" title="Speak Mode" id="chicken-chatbot-speak-toggle" aria-pressed="false">üîä</button>
          <button class="chicken-chatbot-btn" title="New Chat" id="chicken-chatbot-new">üîÑ</button>
          <button class="chicken-chatbot-btn" title="Minimize" id="chicken-chatbot-min">üóï</button>
        </div>
        <div class="chicken-chatbot-body">
          <div class="chicken-chatbot-messages" id="chicken-chatbot-messages"></div>
        </div>
        <div class="chicken-chatbot-footer">
          <input class="chicken-chatbot-input" id="chicken-chatbot-input" type="text" placeholder="Type your message..." autocomplete="off" />
          <button class="chicken-chatbot-send-btn" id="chicken-chatbot-send">Send</button>
        </div>
      `;
      document.body.appendChild(chatbot);

      // Minimize/restore logic
      const minBtn = chatbot.querySelector('#chicken-chatbot-min');
      const newBtn = chatbot.querySelector('#chicken-chatbot-new');
      const face = chatbot.querySelector('.chicken-face');
      const speakToggle = chatbot.querySelector('#chicken-chatbot-speak-toggle');
      let speakMode = false;
      function speakBotMsg(text) {
        if (!('speechSynthesis' in window)) return;
        const utter = new window.SpeechSynthesisUtterance(text);
        const voices = window.speechSynthesis.getVoices();
        if (voices && voices.length) {
          // Prefer animal/cartoon/bird voices, else default
          let chickenVoice = voices.find(v => /chicken|bird|duck|cartoon|fun|animal|silly|squeaky|helium/i.test(v.name));
          utter.voice = chickenVoice || voices[0];
        }
        // Make the voice sound more like a chicken: high pitch, fast, short
        utter.rate = 1.5 + Math.random() * 0.4; // 1.5 - 1.9
        utter.pitch = 2.0 + Math.random() * 0.7; // 2.0 - 2.7
        utter.volume = 1;
        // Optionally, break up long phrases into short bursts for more "chickeny" effect
        if (text.length > 18) {
          let parts = text.split(/[!?.]/).filter(Boolean);
          let delay = 0;
          for (let part of parts) {
            const u = new window.SpeechSynthesisUtterance(part.trim());
            u.voice = utter.voice;
            u.rate = utter.rate;
            u.pitch = utter.pitch;
            u.volume = utter.volume;
            setTimeout(() => window.speechSynthesis.speak(u), delay);
            delay += 350 + Math.random() * 200;
          }
        } else {
          window.speechSynthesis.speak(utter);
        }
      }
      if (speakToggle) {
        speakToggle.onclick = function() {
          speakMode = !speakMode;
          speakToggle.setAttribute('aria-pressed', speakMode ? 'true' : 'false');
          speakToggle.style.color = speakMode ? '#a85c1a' : '#d97428';
        };
      }
      minBtn.onclick = () => chatbot.classList.add('minimized');
      face.onclick = () => chatbot.classList.remove('minimized');

      // New Chat logic
      newBtn.onclick = () => {
        const msgBox = chatbot.querySelector('#chicken-chatbot-messages');
        msgBox.innerHTML = '';
        const greeting = randomGreeting();
        addBotMsg(greeting);
        if (speakMode) speakBotMsg(greeting);
      };

      // Message logic
      const input = chatbot.querySelector('#chicken-chatbot-input');
      const sendBtn = chatbot.querySelector('#chicken-chatbot-send');
      const msgBox = chatbot.querySelector('#chicken-chatbot-messages');

      function addMsg(text, who) {
        const msg = document.createElement('div');
        msg.className = 'chicken-chatbot-message ' + who;
        msg.textContent = text;
        msgBox.appendChild(msg);
        msgBox.scrollTop = msgBox.scrollHeight;
      }
      function addBotMsg(text) { addMsg(text, 'bot'); }
      function addUserMsg(text) { addMsg(text, 'user'); }

      function randomGreeting() {
        const greetings = [
          'Bawk bawk bawk! Cluck cluck cluck! Peep peep peep! Squawk squawk!',
          'Cluck cluck cluck! Bawk-a-ROO! Peepity peep bawk bawk!',
          'Squawkity squawk! Peep peep peep! Bawk bawk!',
          'Peep peep peep! Bawk bawk! Cluck cluck! Bawk bawk!',
          'Bawk bawk! Cluck cluck! Peep! Squawk squawk!',
          'Bawk-a-ROO! Cluck cluck! Peep peep! Squawk squawk!',
          'Peepity peep bawk bawk! Cluck cluck! Squawk squawk!',
          'Squawk squawk! Cluck cluck! Bawk bawk bawk!',
          'Bawk bawk! Peep peep! Cluck cluck! Squawkity squawk!',
          'Cluck-a-doodle cluck! Bawk bawk bawk! Peep peep!'
        ];
        return greetings[Math.floor(Math.random() * greetings.length)];
      }
      function randomChickenReply() {
        const sounds = [
          'Bawk bawk bawk! Cluck-a-doodle-doo! Peep peep, squawk squawk! Bawk bawk bawk bawk!',
          'Cluck cluck cluck cluck bawk bawk bawk! Peep peep! Squawk squawk squawk!',
          'Squawkity squawk! Peep peep bawk bawk! Cluck cluck cluck cluck!',
          'Bawk bawk! Cluck cluck! Peep peep! Bawk bawk bawk!',
          'Cluck-a-doodle-doo! Bawk bawk bawk! Peep peep! Squawk squawk!',
          'Peep peep! Bawk bawk bawk bawk! Cluck cluck! Squawk squawk!',
          'Squawk! Cluck cluck cluck! Bawk bawk! Peep peep peep!',
          'Bawk bawk! Peep peep! Cluck cluck! Squawk squawk squawk!',
          'Cluck cluck! Bawk bawk bawk bawk! Peep peep! Squawkity squawk!',
          'Squawkity squawk! Peep peep! Bawk bawk! Cluck cluck cluck!',
          'Bawk-a-ROO! Cluck cluck squawk! Peep peep! Bawk bawk bawk!',
          'Peep peep peep! Bawk bawk bawk! Cluck cluck! Squawk squawk!',
          'Cluck cluck! Squawk squawk! Peep! Bawk bawk! Cluck cluck!',
          'Bawk bawk bawkity bawk! Cluck cluck! Peep peep! Squawk squawk!',
          'Squawk-a-doodle! Peep peep cluck cluck! Bawk bawk! Cluck cluck!',
          'Cluck cluck cluck! Bawk bawk-a-doodle! Peep peep! Squawk squawk!',
          'Peepity peep! Squawk squawk! Bawk bawk! Cluck cluck cluck!',
          'Bawk bawk! Cluck cluck! Peep peep! Squawk! Bawk bawk bawk!',
          'Squawkity squawk! Bawk bawk bawk! Cluck cluck! Peep peep!',
          'Cluck-a-doodle cluck! Peep peep! Bawk bawk! Squawk squawk!'
        ];
        return sounds[Math.floor(Math.random() * sounds.length)];
      }

      // Initial greeting
      const initialGreeting = randomGreeting();
      addBotMsg(initialGreeting);
      if (speakMode) speakBotMsg(initialGreeting);

      function sendUserMsg() {
        const val = input.value.trim();
        if (!val) return;
        addUserMsg(val);
        input.value = '';
        setTimeout(() => {
          const reply = randomChickenReply();
          addBotMsg(reply);
          if (speakMode) speakBotMsg(reply);
        }, 600 + Math.random() * 400);
      }
      sendBtn.onclick = sendUserMsg;
      input.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') sendUserMsg();
      });
    })();
    // --- End Chicken Chatbot ---
    
    // --- Enhanced Button Hover Effects ---
    document.addEventListener('DOMContentLoaded', function() {
      const buttons = document.querySelectorAll('button');
      buttons.forEach(btn => {
        btn.addEventListener('mouseenter', function() {
          this.style.transform = 'translateY(-2px) scale(1.02)';
        });
        btn.addEventListener('mouseleave', function() {
          this.style.transform = 'translateY(0) scale(1)';
        });
      });
    });
  </script>
</body>
</html>